# prediction_insurance_cost

## Общее описание набора данных

Данный проект посвящен предсказанию стоимости страховки на здоровье с помощью модели линейной регрессии и создания приложения для предсказания стоимости с использованием языка программирования Python. В проекте использовался датасет из книги "Machine Learning with R", скачанный по [ссылке](https://github.com/stedy/Machine-Learning-with-R-datasets/blob/master/insurance.csv). В наборе данных содержится следующая информация:

- возраст (поле age)
- пол (поле sex)
- индекс массы тела (поле bmi)
- кол-во детей у респондента (поле children)
- является ли респондент курильщиком или нет (поле smoker)
- регион проживания (поле region)
- стоимость страховки здоровья (поле charges)

## Использованные модули и библиотеки Python

Разведочный анализ данных произведен с помощью библиотек pandas и seaborn для построения графиков. Доя подготовки данных к построению модели использовался модуль sklearn для кодирования категориальных признаков, сформирования обучающей и тестовой выборки, в дальнейшем с этим модулем было произведено построение модели линейной регрессии. Для создания приложения применялась библиотека streamlit, pillow для загрузки изображений, plotly для создания интерактивных графиков, описывающих данные и объясняющих полученную стоимость страховки на здоровье.

## Содержимое репозитория

В файле [pred_insurance.ipynb](https://github.com/yana-b27/prediction_insurance_cost/blob/main/eda_and_prediction_model/pred_insurance.ipynb) находится информация о разведочном анализе данных и о построении модели линейной регрессии. В файле [model_file.py](https://github.com/yana-b27/prediction_insurance_cost/blob/main/model_file.py) - предварительная обработка данных и предсказательная модель, собранные в виде функций, агрегирующих процесс предсказания. В файле [model_app.py](https://github.com/yana-b27/prediction_insurance_cost/blob/main/model_app.py) содержится скрипт приложения streamlit, который импортирует функции из модуля model_file. В папке [data](https://github.com/yana-b27/prediction_insurance_cost/tree/main/data) находится файл с коэффициентами модели регрессии model_weights.mw, файлы изображений, использованные для создания приложения streamlit и для создания файла readme.md. Изображение для приложения было получено по [ссылке](https://unsplash.com/photos/KltoLK6Mk-g)

## Общее описание приложения

В приложении stremalit пользователи могут задать параметры для предсказания стоимости страховки в специальном поле, причем в поле ввода данных установлены значения по умолчанию. Параллельно с полем ввода данных в приложении есть поле, интерпретирующее полученный результат предсказания на основе модели. В нем присутствуют интерактивные графики, которые помогают пользователю интерпретировать предсказание вместе с объясняющим текстом.

![Интерактивные графики в приложении streamlit](https://github.com/yana-b27/prediction_insurance_cost/blob/main/data/pred_cost_graphs.gif)
